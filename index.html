<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Â∞àÊ°àË®àÁï´ÁÆ°ÁêÜÂπ≥Âè∞</title>

    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"
        rel="stylesheet">

    <script src="https://unpkg.com/dayjs@1/dayjs.min.js"></script>
    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <link rel="stylesheet" href="style.css">
</head>

<body :class="[themeClasses.body, 'transition-theme min-h-screen pb-20']">
    <div id="particle-container" class="no-print"></div>

    <div id="app" v-cloak class="max-w-[1400px] mx-auto p-4 md:p-8">

        <div v-if="showToast"
            class="fixed bottom-8 left-1/2 z-[99] bg-slate-800 text-white px-6 py-3 rounded-lg font-bold shadow-2xl flex items-center gap-3 animate-toast">
            <i class="fa-solid fa-circle-check text-emerald-400"></i>
            <span>{{ toastMessage }}</span>
            <button v-if="toastHasUndo" @click="handleUndo"
                class="ml-2 px-2 py-0.5 bg-slate-600 hover:bg-slate-500 rounded text-xs uppercase tracking-wide transition-colors">
                <i class="fa-solid fa-rotate-left mr-1"></i> Âæ©Âéü
            </button>
        </div>

        <div v-if="showNewProjectModal"
            class="fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4"
            @click.self="showNewProjectModal = false">
            <div :class="[themeClasses.card, 'w-full max-w-2xl rounded-3xl p-8 shadow-2xl transform transition-all']">
                <h3 class="text-2xl font-black mb-6 flex items-center gap-3">
                    <i class="fa-solid fa-wand-magic-sparkles text-indigo-500"></i> Âª∫Á´ãÊñ∞Â∞àÊ°à
                </h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-8">
                    <button @click="createFromTemplate(null)"
                        :class="[themeClasses.innerCard, 'p-6 rounded-2xl border-2 border-dashed border-slate-300 hover:border-indigo-500 hover:bg-indigo-50/50 transition-all text-left group']">
                        <div
                            class="w-12 h-12 rounded-full bg-slate-100 flex items-center justify-center mb-4 group-hover:bg-indigo-500 group-hover:text-white transition-colors">
                            <i class="fa-solid fa-file text-xl"></i>
                        </div>
                        <div class="font-bold text-lg mb-1">Á©∫ÁôΩÂ∞àÊ°à</div>
                        <div class="text-xs opacity-60">ÂæûÈõ∂ÈñãÂßãÂª∫Á´ãÂÖ®Êñ∞ÁöÑÂ∞àÊ°àË®àÁï´</div>
                    </button>

                    <button v-for="tpl in templates" :key="tpl.id" @click="createFromTemplate(tpl)"
                        :class="[themeClasses.innerCard, 'p-6 rounded-2xl border border-slate-200 hover:border-indigo-500 hover:bg-indigo-50/50 transition-all text-left group shadow-sm']">
                        <div
                            class="w-12 h-12 rounded-full bg-indigo-100 text-indigo-600 flex items-center justify-center mb-4 group-hover:bg-indigo-600 group-hover:text-white transition-colors">
                            <i class="fa-solid fa-copy text-xl"></i>
                        </div>
                        <div class="font-bold text-lg mb-1 truncate">{{ tpl.name }}</div>
                        <div class="text-xs opacity-60">{{ tpl.activities.length }} ÂÄã‰ªªÂãôÁØÄÈªû ¬∑ {{ tpl.risks.length }} ÂÄãÈ¢®Èö™È†êË®≠
                        </div>
                    </button>
                </div>
                <div class="flex justify-end">
                    <button @click="showNewProjectModal = false"
                        class="px-6 py-2 text-slate-400 font-bold hover:text-slate-600">ÂèñÊ∂à</button>
                </div>
            </div>
        </div>

        <header
            :class="[themeClasses.card, 'glass no-print flex flex-col md:flex-row justify-between items-center mb-6 p-6 rounded-2xl border shadow-lg transition-theme relative overflow-hidden']">
            <div
                class="absolute -top-20 -right-20 w-40 h-40 bg-gradient-to-br from-indigo-500/20 to-purple-500/20 rounded-full blur-3xl">
            </div>
            <div
                class="absolute -bottom-10 -left-10 w-32 h-32 bg-gradient-to-br from-cyan-500/15 to-blue-500/15 rounded-full blur-2xl">
            </div>

            <div class="flex items-center gap-4 mb-4 md:mb-0 relative z-10">
                <div
                    class="w-14 h-14 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-xl flex items-center justify-center text-white text-2xl logo-animated">
                    <i class="fa-solid fa-layer-group"></i>
                </div>
                <div>
                    <h1 :class="[themeClasses.brand, 'text-2xl font-black tracking-tight']"> ‚ú® Â∞àÊ°àË®àÁï´ÁÆ°ÁêÜÂπ≥Âè∞ üíé
                        <span
                            class="text-[10px] align-top bg-gradient-to-r from-indigo-500 to-purple-600 sakura:from-pink-400 sakura:to-rose-500 text-white px-2 py-0.5 rounded-full ml-1 font-bold">v2.1
                            üöÄ</span>
                    </h1>
                    <p class="text-sm opacity-50 font-bold flex items-center gap-2">
                        üéÄ Â∞àÊ°àÁµÑÂêàÁÆ°ÁêÜÁ≥ªÁµ± (PPM) üìÇ
                        <span class="kbd hidden md:inline-flex" title="Êåâ N Êñ∞Â¢ûÂ∞àÊ°à">N</span>
                    </p>
                </div>
            </div>

            <div class="flex gap-2 md:gap-3 relative z-10">
                <div
                    class="flex bg-slate-100/80 dark:bg-slate-800/80 sakura:bg-pink-50/80 animal:bg-amber-50/80 p-1 rounded-xl border border-slate-200/50 dark:border-slate-700/50 sakura:border-pink-200/50 backdrop-blur-sm">
                    <button @click="setTheme('light')" 
                        :class="[theme === 'light' ? 'bg-white shadow-md text-indigo-600' : 'text-slate-400 hover:text-slate-600', 'w-9 h-9 rounded-lg flex items-center justify-center transition-all btn-ripple']">
                        <i class="fa-solid fa-sun"></i>
                    </button>
                    <button @click="setTheme('forest')" 
                        :class="[theme === 'forest' ? 'bg-[#2d6a4f] text-white shadow-md' : 'text-slate-400 hover:text-slate-600', 'w-9 h-9 rounded-lg flex items-center justify-center transition-all btn-ripple']">
                        <i class="fa-solid fa-tree"></i>
                    </button>
                    <button @click="setTheme('sakura')" 
                        :class="[theme === 'sakura' ? 'bg-pink-500 text-white shadow-md' : 'text-slate-400 hover:text-slate-600', 'w-9 h-9 rounded-lg flex items-center justify-center transition-all btn-ripple']">
                        <i class="fa-solid fa-fan"></i> </button>
                    <button @click="setTheme('animal')" 
                        :class="[theme === 'animal' ? 'bg-amber-500 text-white shadow-md' : 'text-slate-400 hover:text-slate-600', 'w-9 h-9 rounded-lg flex items-center justify-center transition-all btn-ripple']">
                        <i class="fa-solid fa-paw"></i>
                    </button>
                </div>

                <div
                    class="flex bg-slate-100/80 dark:bg-slate-800/80 sakura:bg-pink-50/80 animal:bg-amber-50/80 p-1 rounded-xl border border-slate-200/50 dark:border-slate-700/50 sakura:border-pink-200/50 backdrop-blur-sm">
                    <button @click="adjustFont(-1)"
                        class="w-9 h-9 text-slate-400 hover:text-slate-600 dark:hover:text-white flex items-center justify-center transition-all btn-ripple"
                        title="Á∏ÆÂ∞èÂ≠óÈ´î (A-)">
                        <span class="text-xs font-bold">A-</span>
                    </button>
                    <div class="w-px h-4 bg-slate-300 dark:bg-slate-600 self-center"></div>
                    <button @click="adjustFont(1)"
                        class="w-9 h-9 text-slate-400 hover:text-slate-600 dark:hover:text-white flex items-center justify-center transition-all btn-ripple"
                        title="ÊîæÂ§ßÂ≠óÈ´î (A+)">
                        <span class="text-base font-bold">A+</span>
                    </button>
                </div>
                <button @click="exportData"
                    class="px-4 py-2 bg-slate-700 hover:bg-slate-800 text-white rounded-xl text-sm font-bold transition-all flex items-center gap-2 btn-ripple shadow-md hover:shadow-lg">
                    <i class="fa-solid fa-download"></i> <span class="hidden md:inline">ÂÇô‰ªΩ</span>
                </button>
                <label
                    class="px-4 py-2 bg-gradient-to-r from-indigo-500 to-purple-600 hover:from-indigo-600 hover:to-purple-700 text-white rounded-xl text-sm font-bold transition-all cursor-pointer flex items-center gap-2 shadow-lg shadow-indigo-500/30 btn-ripple">
                    <i class="fa-solid fa-upload"></i> <span class="hidden md:inline">ÂåØÂÖ•</span>
                    <input type="file" @change="importData" class="hidden" accept=".json">
                </label>
            </div>
        </header>

        <nav class="no-print flex gap-2 mb-8 border-b border-slate-200 dark:border-slate-700 pb-1 overflow-x-auto">
            <button v-for="tab in tabs" :key="tab.id" @click="currentTab = tab.id"
                :class="['px-6 py-3 text-sm font-bold rounded-t-lg transition-all border-b-2 whitespace-nowrap', currentTab === tab.id ? 'border-indigo-500 text-indigo-600 bg-indigo-50/50 dark:bg-slate-800 dark:text-indigo-400' : 'border-transparent text-slate-400 hover:text-slate-600']">
                <i :class="['fa-solid mr-2', tab.icon]"></i>{{tab.n}}
            </button>
        </nav>

        <main v-if="currentTab === 'time'" class="animate-fade-in">
            <section
                :class="[themeClasses.card, 'glass p-8 rounded-3xl shadow-xl border transition-theme overflow-hidden relative']">
                <div
                    class="absolute -top-32 -right-32 w-64 h-64 bg-gradient-to-br from-indigo-500/10 to-purple-500/10 rounded-full blur-3xl pointer-events-none">
                </div>

                <div class="flex flex-col md:flex-row items-start md:items-center justify-between mb-8 gap-4">
                    <h2 class="font-black text-xl flex items-center gap-3">
                        <div
                            class="w-10 h-10 bg-gradient-to-br from-indigo-500 to-purple-600 sakura:from-pink-400 sakura:to-rose-500 rounded-xl flex items-center justify-center text-white">
                            <i class="fa-solid fa-chart-gantt"></i>
                        </div>
                        <span>üóìÔ∏è {{ new Date().getFullYear() }} Âπ¥Â∫¶Â∞àÊ°àÂÖ®Ë¶Ω üåà</span>
                        <span
                            class="text-xs font-medium bg-indigo-100 text-indigo-600 dark:bg-indigo-900/30 dark:text-indigo-400 sakura:bg-pink-100 sakura:text-pink-600 px-2 py-0.5 rounded-full">üî•
                            {{
                            activeProjects.length }} ÈÄ≤Ë°å‰∏≠</span>
                    </h2>
                    <div class="flex gap-3 text-xs font-bold">
                        <span
                            class="flex items-center gap-1.5 px-3 py-1.5 bg-emerald-50 dark:bg-emerald-900/20 sakura:bg-green-50 rounded-full text-emerald-600 dark:text-emerald-400 sakura:text-green-600">
                            <span class="w-2 h-2 rounded-full bg-emerald-500"></span> ‚úÖ Ê≠£Â∏∏
                        </span>
                        <span
                            class="flex items-center gap-1.5 px-3 py-1.5 bg-amber-50 dark:bg-amber-900/20 sakura:bg-orange-50 rounded-full text-amber-600 dark:text-amber-400 sakura:text-orange-600">
                            <span class="w-2 h-2 rounded-full bg-amber-500"></span> ‚ö†Ô∏è È¢®Èö™
                        </span>
                        <span
                            class="flex items-center gap-1.5 px-3 py-1.5 bg-rose-50 dark:bg-rose-900/20 sakura:bg-pink-100 rounded-full text-rose-600 dark:text-rose-400 sakura:text-rose-600">
                            <span class="w-2 h-2 rounded-full bg-rose-500 animate-pulse"></span> üÜò Âç°Èóú
                        </span>
                    </div>
                </div>
                <div class="relative overflow-x-auto pb-4">
                    <div class="min-w-[1000px] xl:min-w-full relative">
                        <div class="flex border-b border-slate-200 dark:border-slate-700 mb-6">
                            <div v-for="m in 12" :key="m"
                                :class="['flex-1 text-center py-2 text-xs font-bold transition-colors', m === new Date().getMonth() + 1 ? 'text-indigo-600 dark:text-indigo-400 bg-indigo-50/50 dark:bg-indigo-900/20' : 'text-slate-400']">
                                {{m}}Êúà
                            </div>
                        </div>
                        <div v-if="activeProjects.length === 0"
                            class="text-center py-16 opacity-40 bg-gradient-to-br from-slate-50 to-slate-100/50 dark:from-slate-800/50 dark:to-slate-800/30 rounded-2xl border-2 border-dashed border-slate-200 dark:border-slate-700">
                            <i class="fa-solid fa-calendar-xmark text-5xl mb-4 block text-slate-300"></i>
                            <div class="font-bold">ÁõÆÂâçÁÑ°ÈÄ≤Ë°å‰∏≠ÁöÑÂ∞àÊ°à</div>
                            <button @click="showNewProjectModal = true"
                                class="mt-4 text-sm text-indigo-500 font-bold hover:underline">+ Âª∫Á´ãÁ¨¨‰∏ÄÂÄãÂ∞àÊ°à</button>
                        </div>
                        <div v-for="(p, pIdx) in activeProjects" :key="p.id"
                            class="relative h-16 border-b border-slate-100 dark:border-slate-700/50 flex items-center group hover:bg-indigo-50/30 dark:hover:bg-indigo-900/10 transition-colors px-2 cursor-pointer focus-visible:bg-indigo-50/50 dark:focus-visible:bg-indigo-900/20 outline-none"
                            tabindex="0" @click="selectedPid = p.id; currentTab = 'project'"
                            @keyup.enter="selectedPid = p.id; currentTab = 'project'">
                            <div class="absolute left-0 -top-2 z-20">
                                <span
                                    class="text-[10px] font-bold bg-white dark:bg-slate-700 px-2.5 py-0.5 rounded-full shadow-sm border border-slate-100 dark:border-slate-600 text-slate-600 dark:text-slate-300 truncate max-w-[150px] inline-block">
                                    {{ p.name }}
                                </span>
                            </div>
                            <div
                                class="w-full h-1.5 bg-slate-100 dark:bg-slate-700 rounded-full relative overflow-hidden">
                                <div class="absolute inset-y-0 left-0 bg-gradient-to-r from-indigo-400 to-purple-500 rounded-full transition-all duration-500 progress-animated"
                                    :style="{ width: calculateProgress(p) + '%' }"></div>
                            </div>
                            <div v-for="act in p.activities" :key="act.id"
                                class="absolute top-1/2 -translate-y-1/2 group/point z-10"
                                :style="{ left: getYearPos(act.date) + '%' }">
                                <div :class="['cursor-pointer transition-all hover:scale-[1.8] focus:scale-[1.8] relative border-2 shadow-md hover:shadow-lg focus:shadow-lg outline-none', act.type === 'deadline' ? 'w-4 h-4 diamond' : 'w-3 h-3 rounded-full', getStatusColorClass(act.status)]"
                                    tabindex="0" @keyup.enter="selectedPid = p.id; currentTab = 'project'"
                                    :title="`${act.date} | ${act.name} (${statusText(act.status)})`">
                                    <i v-if="act.status === 'blocked'"
                                        class="fa-solid fa-exclamation text-white text-[8px] absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 -rotate-45"></i>
                                </div>
                                <div
                                    class="absolute bottom-full left-1/2 -translate-x-1/2 mb-2 px-3 py-2 bg-slate-900 text-white text-[10px] rounded-lg whitespace-nowrap opacity-0 group-hover/point:opacity-100 transition-opacity pointer-events-none z-50 shadow-xl">
                                    <div class="font-bold">{{ act.name }}</div>
                                    <div class="text-slate-400">{{ act.date }} ¬∑ {{ statusText(act.status) }}</div>
                                    <div
                                        class="absolute top-full left-1/2 -translate-x-1/2 border-4 border-transparent border-t-slate-900">
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div v-if="isCurrentYear"
                            class="absolute top-0 bottom-0 w-0.5 bg-gradient-to-b from-rose-500 via-rose-500 to-transparent z-20 pointer-events-none today-line"
                            :style="{ left: getYearPos(today) + '%' }">
                            <div
                                class="bg-rose-500 text-white text-[9px] px-2 py-0.5 rounded-full absolute -top-6 left-1/2 -translate-x-1/2 font-bold whitespace-nowrap shadow-lg shadow-rose-500/30">
                                TODAY
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <main v-if="currentTab === 'project'" class="grid grid-cols-1 lg:grid-cols-12 gap-6 animate-fade-in">
            <aside class="lg:col-span-3 flex flex-col h-[calc(100vh-200px)]">
                <button @click="showNewProjectModal = true"
                    class="w-full py-4 bg-gradient-to-r from-indigo-500 to-purple-600 hover:from-indigo-600 hover:to-purple-700 text-white rounded-2xl shadow-lg shadow-indigo-500/30 hover:shadow-indigo-500/50 hover:-translate-y-1 transition-all font-black text-sm flex items-center justify-center gap-2 mb-4 shrink-0 btn-ripple">
                    <i class="fa-solid fa-plus"></i> Âª∫Á´ãÊñ∞Â∞àÊ°à <span
                        class="kbd ml-1 bg-white/20 border-white/30 text-white text-[9px]">N</span>
                </button>

                <div class="relative mb-4 shrink-0">
                    <i class="fa-solid fa-search absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 text-sm"></i>
                    <input v-model="searchQuery" type="text" placeholder="üîç ÊêúÂ∞ãÂ∞àÊ°àÂêçÁ®±ÊàñÂÆ¢Êà∂..."
                        class="w-full pl-10 pr-4 py-2.5 bg-white dark:bg-slate-800 sakura:bg-white/80 border border-slate-200 dark:border-slate-700 sakura:border-pink-200 rounded-xl text-sm font-medium placeholder-slate-400 transition-all">
                </div>

                <div class="flex p-1 bg-slate-100/80 dark:bg-slate-800/80 rounded-xl mb-4 shrink-0 backdrop-blur-sm">
                    <button @click="listFilter = 'active'"
                        :class="['flex-1 py-2 text-xs font-bold rounded-lg transition-all', listFilter === 'active' ? 'bg-white dark:bg-slate-700 sakura:bg-pink-100 shadow-md text-indigo-600 dark:text-white sakura:text-pink-600' : 'text-slate-400 hover:text-slate-600']">
                        <i class="fa-solid fa-play mr-1"></i> üöÄ ÈÄ≤Ë°å‰∏≠
                    </button>
                    <button @click="listFilter = 'completed'"
                        :class="['flex-1 py-2 text-xs font-bold rounded-lg transition-all', listFilter === 'completed' ? 'bg-white dark:bg-slate-700 sakura:bg-pink-100 shadow-md text-emerald-600 dark:text-white sakura:text-rose-500' : 'text-slate-400 hover:text-slate-600']">
                        <i class="fa-solid fa-check mr-1"></i> ‚úÖ Â∑≤ÁµêÊ°à
                    </button>
                </div>
                <div class="space-y-3 overflow-y-auto pr-1 flex-1">
                    <div v-if="searchedProjects.length === 0" class="text-center py-12 opacity-40">
                        <i class="fa-solid fa-folder-open text-4xl mb-3 block"></i>
                        <div class="text-xs font-bold">{{ searchQuery ? 'Êâæ‰∏çÂà∞Á¨¶ÂêàÁöÑÂ∞àÊ°à' : 'Ê≤íÊúâ' +
                            (listFilter==='active'?'ÈÄ≤Ë°å‰∏≠':'Â∑≤ÁµêÊ°à') + 'ÁöÑÂ∞àÊ°à' }}</div>
                        <button v-if="!searchQuery && listFilter==='active'" @click="showNewProjectModal = true"
                            class="mt-3 text-xs text-indigo-500 font-bold hover:underline">+ Âª∫Á´ãÁ¨¨‰∏ÄÂÄãÂ∞àÊ°à</button>
                    </div>
                    <div v-for="(p, index) in searchedProjects" :key="p.id" @click="selectedPid = p.id"
                        @keyup.enter="selectedPid = p.id" tabindex="0"
                        :class="['p-4 rounded-2xl cursor-pointer transition-all border-l-4 group relative overflow-hidden hover-lift focus-visible:ring-2 focus-visible:ring-indigo-500 outline-none', selectedPid === p.id ? themeClasses.activeItem : themeClasses.inactiveItem]"
                        :style="{ animationDelay: index * 50 + 'ms' }">
                        <div class="flex justify-between items-start mb-2 relative z-10">
                            <div class="font-bold truncate pr-2 text-sm">{{ p.name }}</div>
                            <div
                                :class="['text-[10px] font-black px-2 py-0.5 rounded-full', calculateProgress(p) === 100 ? 'bg-emerald-100 text-emerald-600' : 'bg-indigo-100 text-indigo-600']">
                                {{
                                calculateProgress(p) }}%</div>
                        </div>
                        <div v-if="p.org" class="text-[10px] text-slate-400 mb-2 truncate relative z-10"><i
                                class="fa-solid fa-building mr-1"></i>{{ p.org }}</div>
                        <div class="flex gap-2 text-[10px] opacity-60 relative z-10 font-bold uppercase">
                            <span v-if="p.status === 'completed'"
                                class="text-emerald-600 bg-emerald-100 px-1 rounded"><i
                                    class="fa-solid fa-check-double mr-1"></i>Â∑≤ÁµêÊ°à</span>
                            <span v-else-if="getRiskCount(p).blocked > 0" class="text-rose-500"><i
                                    class="fa-solid fa-ban mr-1"></i>{{ getRiskCount(p).blocked }} Âç°Èóú</span>
                            <span v-else class="text-slate-500">ÈÄ≤Ë°å‰∏≠</span>
                        </div>
                        <div class="absolute bottom-0 left-0 h-1 bg-indigo-500/20 transition-all duration-500"
                            :style="{ width: calculateProgress(p) + '%' }"></div>
                    </div>
                </div>
            </aside>

            <article v-if="activeProject"
                :class="[themeClasses.card, 'lg:col-span-9 p-6 md:p-10 rounded-3xl shadow-xl border transition-theme relative']">

                <div class="absolute top-6 right-6 z-20 flex gap-2">
                    <button @click="saveAsTemplate"
                        class="px-3 py-1.5 bg-amber-50 text-amber-600 hover:bg-amber-100 rounded-lg text-xs font-bold transition-all border border-amber-200"
                        title="Âè¶Â≠òÁÇ∫Êñ∞ÁØÑÊú¨">
                        <i class="fa-solid fa-copy mr-1"></i> ËΩâÁØÑÊú¨
                    </button>
                    <button v-if="activeProject.status !== 'completed'" @click="toggleProjectStatus"
                        class="px-3 py-1.5 bg-emerald-50 text-emerald-600 hover:bg-emerald-100 rounded-lg text-xs font-bold transition-all border border-emerald-200">
                        <i class="fa-solid fa-box-archive mr-1"></i> ÁµêÊ°à
                    </button>
                    <button v-else @click="toggleProjectStatus"
                        class="px-3 py-1.5 bg-slate-100 text-slate-600 hover:bg-slate-200 rounded-lg text-xs font-bold transition-all border border-slate-200">
                        <i class="fa-solid fa-box-open mr-1"></i> ÈáçÂïü
                    </button>
                    <button @click="deleteProject"
                        class="px-3 py-1.5 bg-rose-50 text-rose-600 hover:bg-rose-100 rounded-lg text-xs font-bold transition-all border border-rose-200">
                        <i class="fa-solid fa-trash-can mr-1"></i> Âà™Èô§
                    </button>
                </div>

                <div class="mt-8 mb-8 pb-6 border-b border-slate-100 dark:border-slate-700 sakura:border-pink-100">
                    <div class="w-full mr-48"> <label class="text-xs font-bold text-slate-400 uppercase tracking-wider mb-1 block">üå∑
                            Â∞àÊ°àÂêçÁ®±</label>
                        <input v-model="activeProject.name" :disabled="isArchived"
                            class="text-3xl font-black bg-transparent outline-none w-full placeholder-slate-300 dark:placeholder-slate-600 sakura:placeholder-pink-200 disabled:opacity-50"
                            placeholder="Ëº∏ÂÖ•Â∞àÊ°àÂêçÁ®±...">
                    </div>
                </div>

                <div v-if="isArchived"
                    class="absolute inset-0 bg-slate-50/50 dark:bg-slate-900/50 z-10 flex items-center justify-center backdrop-blur-[1px] rounded-3xl pointer-events-none">
                    <div
                        class="bg-white dark:bg-slate-800 px-6 py-3 rounded-full shadow-2xl border border-slate-200 dark:border-slate-700 font-bold text-slate-500 flex items-center gap-2">
                        <i class="fa-solid fa-lock"></i> Â∞àÊ°àÂ∑≤ÁµêÊ°à (ÂîØËÆÄ)
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-10">
                    <div :class="[themeClasses.innerCard, 'p-5 rounded-2xl border shadow-sm']">
                        <h3
                            class="text-xs font-black opacity-50 uppercase tracking-widest mb-4 flex items-center gap-2">
                            <i class="fa-solid fa-users text-indigo-500"></i> Âà©ÂÆ≥Èóú‰øÇ‰∫∫
                        </h3>
                        <input v-model="activeProject.org" placeholder="ÂÆ¢Êà∂ / ÂñÆ‰ΩçÂêçÁ®±"
                            class="w-full bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded px-3 py-2 text-sm font-bold outline-none mb-3">
                        <div class="space-y-2 max-h-40 overflow-y-auto custom-scroll pr-1">
                            <div v-for="(contact, cIdx) in activeProject.contacts" :key="cIdx" class="flex gap-2">
                                <input v-model="contact.name" placeholder="ÂßìÂêç"
                                    class="w-1/3 bg-transparent border-b border-slate-200 text-xs py-1 outline-none">
                                <input v-model="contact.info" placeholder="Ë≥áË®ä"
                                    class="flex-1 bg-transparent border-b border-slate-200 text-xs py-1 outline-none">
                                <button @click="removeContact(cIdx)" class="text-slate-300 hover:text-rose-500"><i
                                        class="fa-solid fa-xmark"></i></button>
                            </div>
                        </div>
                        <button @click="addContact" class="text-indigo-500 font-bold text-xs mt-3">+ Êñ∞Â¢ûÈóú‰øÇ‰∫∫</button>
                    </div>

                    <div
                        :class="[themeClasses.innerCard, 'p-5 rounded-2xl border shadow-sm bg-rose-50/30 dark:bg-rose-900/10 border-rose-100 dark:border-rose-900/30']">
                        <h3
                            class="text-xs font-black opacity-50 uppercase tracking-widest mb-4 flex items-center gap-2 text-rose-600">
                            <i class="fa-solid fa-fire-extinguisher"></i> È¢®Èö™ËàáË≠∞È°å
                        </h3>
                        <div class="space-y-3 max-h-40 overflow-y-auto custom-scroll pr-1">
                            <div v-for="(risk, rIdx) in activeProject.risks" :key="rIdx"
                                class="bg-white dark:bg-slate-800 p-3 rounded-xl border border-rose-100 dark:border-rose-900/50 shadow-sm group">
                                <div class="flex justify-between items-center mb-1">
                                    <select v-model="risk.level" :class="getRiskLevelClass(risk.level)"
                                        class="text-[10px] font-black uppercase px-2 py-0.5 rounded outline-none border-none cursor-pointer">
                                        <option value="high">È´ò</option>
                                        <option value="med">‰∏≠</option>
                                        <option value="low">‰Ωé</option>
                                    </select>
                                    <button @click="removeRisk(rIdx)"
                                        class="text-slate-300 hover:text-rose-500 opacity-0 group-hover:opacity-100"><i
                                            class="fa-solid fa-xmark"></i></button>
                                </div>
                                <input v-model="risk.desc" placeholder="È¢®Èö™ÂÖßÂÆπ..."
                                    class="w-full bg-transparent text-xs font-bold outline-none mb-1">
                                <input v-model="risk.action" placeholder="‚Üí Á∑©Ëß£Â∞çÁ≠ñ"
                                    class="w-full bg-transparent text-[10px] text-slate-500 outline-none">
                            </div>
                        </div>
                        <button @click="addRisk" class="text-rose-500 font-bold text-xs mt-3">+ Êñ∞Â¢ûÈ¢®Èö™</button>
                    </div>
                </div>

                <div class="flex justify-between items-center mb-6">
                    <h3 class="font-black text-lg text-slate-700 dark:text-slate-200 sakura:text-pink-700">üìå Â∞àÊ°àÈáåÁ®ãÁ¢ë & ‰ªªÂãô
                    </h3>
                    <div class="flex gap-3">
                        <div
                            class="flex bg-slate-100 dark:bg-slate-800 p-1 rounded-lg border border-slate-200 dark:border-slate-700">
                            <button @click="viewMode = 'list'"
                                :class="['px-3 py-1 rounded-md text-xs font-bold transition-all', viewMode === 'list' ? 'bg-white dark:bg-slate-700 shadow text-indigo-600' : 'text-slate-400']"><i
                                    class="fa-solid fa-list ul"></i></button>
                            <button @click="viewMode = 'board'"
                                :class="['px-3 py-1 rounded-md text-xs font-bold transition-all', viewMode === 'board' ? 'bg-white dark:bg-slate-700 shadow text-indigo-600' : 'text-slate-400']"><i
                                    class="fa-solid fa-table-columns"></i></button>
                        </div>
                        <button @click="addActivity"
                            class="px-4 py-2 bg-indigo-600 sakura:bg-pink-500 text-white rounded-lg hover:bg-indigo-500 sakura:hover:bg-pink-400 shadow-lg font-bold text-xs flex items-center gap-2"><i
                                class="fa-solid fa-plus"></i> ‚ú® Êñ∞Â¢û‰ªªÂãô</button>
                    </div>
                </div>

                <div v-if="viewMode === 'list'" class="space-y-4">
                    <div v-for="(act, idx) in sortedActivities" :key="act.id" draggable="true"
                        @dragstart="handleDragStart(idx)" @dragenter="handleDragEnter(idx)" @dragover.prevent
                        @dragend="handleDragEnd"
                        :class="[themeClasses.innerCard, 'draggable-item p-4 rounded-2xl border transition-all hover:shadow-md flex flex-col xl:flex-row gap-4 items-start xl:items-center', dragIndex === idx ? 'dragging' : '']">
                        <div class="relative group/status shrink-0 flex items-center"
                            @keyup.esc="act.showStatusMenu = false">
                            <i class="fa-solid fa-grip-vertical drag-handle mr-2 text-slate-300 hover:text-slate-500 cursor-grab"
                                title="ÊãñÊõ≥ÊéíÂ∫è"></i>
                            <button @click="act.showStatusMenu = !act.showStatusMenu"
                                @blur="setTimeout(() => act.showStatusMenu = false, 200)"
                                :class="['w-32 py-1.5 rounded-lg text-[10px] font-black uppercase tracking-wider border flex items-center justify-center gap-2 transition-all focus:ring-2 focus:ring-offset-1 outline-none', getStatusBtnClass(act.status)]">
                                <i :class="statusIcon(act.status)"></i> {{ statusText(act.status) }}
                            </button>
                            <div v-if="act.showStatusMenu"
                                class="absolute top-full left-0 w-36 bg-white dark:bg-slate-800 shadow-xl rounded-xl z-50 border border-slate-100 dark:border-slate-600 mt-1 animate-scale-up">
                                <div v-for="s in ['pending','ontrack','risk','blocked','done']" :key="s"
                                    @click="act.status = s; act.showStatusMenu = false"
                                    class="px-3 py-2 text-xs font-bold hover:bg-slate-50 dark:hover:bg-slate-700 cursor-pointer flex items-center gap-2 text-slate-600 dark:text-slate-300">
                                    <div :class="['w-2 h-2 rounded-full', getStatusDot(s)]"></div> {{ statusText(s) }}
                                </div>
                            </div>
                        </div>
                        <div class="flex gap-2 shrink-0">
                            <input type="date" v-model="act.date"
                                class="bg-slate-100 dark:bg-slate-900 border-transparent focus:border-indigo-500 rounded px-2 py-1.5 text-xs font-bold outline-none text-slate-600 dark:text-slate-300">
                            <select v-model="act.type"
                                class="bg-slate-100 dark:bg-slate-900 rounded px-2 py-1.5 text-xs font-bold outline-none border-transparent focus:border-indigo-500 text-slate-600 dark:text-slate-300">
                                <option value="activity">‰ªªÂãô</option>
                                <option value="deadline">ÈáåÁ®ãÁ¢ë</option>
                            </select>
                        </div>
                        <div class="shrink-0 relative">
                            <i
                                class="fa-solid fa-user text-slate-300 absolute left-2 top-1/2 -translate-y-1/2 text-[10px]"></i>
                            <input v-model="act.owner" placeholder="Ë≤†Ë≤¨‰∫∫"
                                class="w-24 pl-6 pr-2 py-1.5 bg-transparent border-b border-slate-200 focus:border-indigo-500 text-xs font-bold outline-none text-center">
                        </div>
                        <div class="flex-1 w-full">
                            <input v-model="act.name" placeholder="‰ªªÂãôÂêçÁ®±"
                                :class="[act.status === 'done' ? 'line-through opacity-50' : '', 'w-full bg-transparent text-sm font-bold outline-none border-b border-transparent focus:border-indigo-500']">
                        </div>
                        <div class="flex items-center gap-3 shrink-0 ml-auto xl:ml-0">
                            <button @click="act.showNote = !act.showNote"
                                :class="[act.note ? 'text-amber-500' : 'text-slate-300 hover:text-slate-500']"><i
                                    class="fa-solid fa-note-sticky"></i></button>
                            <button @click="removeActivity(idx)"
                                class="text-slate-300 hover:text-rose-500 w-6 h-6 flex items-center justify-center rounded"><i
                                    class="fa-solid fa-xmark"></i></button>
                        </div>
                        <div v-if="act.showNote"
                            class="w-full mt-2 pt-2 border-t border-slate-100 dark:border-slate-700/50">
                            <textarea v-model="act.note"
                                class="w-full h-20 bg-slate-50 dark:bg-slate-900 rounded-lg p-3 text-xs outline-none border border-slate-200 resize-none"
                                placeholder="ÂÇôË®ª..."></textarea>
                        </div>
                    </div>
                </div>

                <div v-else class="grid grid-cols-1 md:grid-cols-4 gap-4 overflow-x-auto pb-4">
                    <div v-for="(col, key) in kanbanColumns" :key="key" @dragover.prevent @drop="handleKanbanDrop(key)"
                        class="min-w-[250px] bg-slate-100/50 dark:bg-slate-800/50 rounded-2xl p-4 border border-slate-200 dark:border-slate-700/50 flex flex-col h-[600px] transition-colors hover:bg-slate-100 dark:hover:bg-slate-800/80">
                        <div class="flex items-center gap-2 mb-4 text-xs font-black uppercase text-slate-500">
                            <i :class="col.icon"></i> {{ col.title }}
                            <span
                                class="ml-auto bg-slate-200 dark:bg-slate-700 text-slate-500 px-2 py-0.5 rounded-full text-[10px]">{{
                                col.items.length }}</span>
                        </div>
                        <div class="flex-1 overflow-y-auto space-y-3 custom-scroll pr-1">
                            <div v-for="act in col.items" :key="act.id" draggable="true"
                                @dragstart="handleKanbanDragStart(act)" @dragend="handleKanbanDragEnd"
                                :class="[themeClasses.innerCard, 'p-3 rounded-xl border shadow-sm cursor-grab active:cursor-grabbing hover-lift']">
                                <div class="flex justify-between items-start mb-2">
                                    <div :class="['w-2 h-2 rounded-full mt-1.5', getStatusDot(act.status)]"></div>
                                    <div class="flex-1 mx-2 text-sm font-bold leading-tight">{{ act.name || 'Êú™ÂëΩÂêç‰ªªÂãô' }}
                                    </div>
                                    <button @click="removeActivityById(act.id)"
                                        class="text-slate-300 hover:text-rose-500"><i
                                            class="fa-solid fa-xmark"></i></button>
                                </div>
                                <div class="flex items-center gap-2 text-[10px] text-slate-400 mt-2">
                                    <span v-if="act.owner"
                                        class="bg-slate-100 dark:bg-slate-700 px-1.5 py-0.5 rounded"><i
                                            class="fa-solid fa-user mr-1"></i>{{ act.owner }}</span>
                                    <span class="bg-slate-100 dark:bg-slate-700 px-1.5 py-0.5 rounded">{{
                                        dayjs(act.date).format('MM/DD') }}</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </article>

            <div v-else
                class="lg:col-span-9 flex flex-col items-center justify-center text-center opacity-30 h-[600px] border-2 border-dashed border-slate-200 dark:border-slate-700 rounded-3xl">
                <i class="fa-solid fa-arrow-left text-6xl mb-4 text-slate-400"></i>
                <p class="text-xl font-bold">Ë´ãÂæûÂ∑¶ÂÅ¥ÂàóË°®ÈÅ∏ÊìáÂ∞àÊ°à</p>
            </div>
        </main>

        <main v-if="currentTab === 'report'" class="animate-fade-in">
            <div v-if="!activeProject" class="text-center p-20 opacity-30 font-bold text-2xl">Ë´ãÂÖàÈÅ∏Êìá‰∏ÄÂÄãÂ∞àÊ°à</div>
            <article v-else :class="[themeClasses.card, 'p-8 md:p-12 rounded-3xl shadow-xl border print-area']">
                <div
                    class="flex justify-between items-start mb-10 pb-6 border-b-4 border-slate-100 dark:border-slate-700 sakura:border-pink-200">
                    <div>
                        <h2 class="text-4xl font-black mb-2">üìä {{ activeProject.name }}</h2>
                        <div class="text-sm opacity-60 font-bold uppercase tracking-wide">{{ activeProject.org || 'Êú™Ë®≠ÂÆö'
                            }} | 2026 üìà Âü∑Ë°åÂ†±Âëä</div>
                    </div>
                    <div class="flex gap-2">
                        <button @click="exportToExcel"
                            class="no-print px-6 py-3 bg-emerald-600 text-white rounded-xl font-bold shadow hover:bg-emerald-700 text-sm flex items-center gap-2"><i
                                class="fa-solid fa-file-excel"></i>ÂåØÂá∫ Excel</button>
                        <button @click="window.print()"
                            class="no-print px-6 py-3 bg-slate-800 text-white rounded-xl font-bold shadow hover:bg-slate-700 text-sm flex items-center gap-2"><i
                                class="fa-solid fa-print"></i>ÂàóÂç∞</button>
                    </div>
                </div>
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-12">
                    <div
                        class="bg-slate-50 dark:bg-slate-800 sakura:bg-pink-50 p-5 rounded-2xl border border-slate-100 dark:border-slate-700 sakura:border-pink-100 text-center">
                        <div class="text-[10px] font-black uppercase text-slate-400 mb-1">üèÅ Á∏ΩÈ´îÈÄ≤Â∫¶</div>
                        <div class="text-3xl font-black text-indigo-600 sakura:text-pink-600">{{
                            calculateProgress(activeProject) }}<span class="text-sm align-top">%</span></div>
                    </div>
                    <div
                        class="bg-rose-50 dark:bg-rose-900/10 sakura:bg-rose-100/50 p-5 rounded-2xl border border-rose-100 dark:border-rose-900/30 sakura:border-rose-200 text-center">
                        <div class="text-[10px] font-black uppercase text-rose-400 mb-1">üÜò Âç°ÈóúÈ†ÖÁõÆ</div>
                        <div class="text-3xl font-black text-rose-500">{{ activeProject.activities.filter(a => a.status
                            === 'blocked').length }}</div>
                    </div>
                    <div
                        class="bg-slate-50 dark:bg-slate-800 sakura:bg-pink-50 p-5 rounded-2xl border border-slate-100 dark:border-slate-700 sakura:border-pink-100 text-center">
                        <div class="text-[10px] font-black uppercase text-slate-400 mb-1">üìù ÂæÖËæ¶/ÈÄ≤Ë°å‰∏≠</div>
                        <div class="text-3xl font-black text-slate-700 dark:text-slate-200 sakura:text-pink-800">{{
                            activeProject.activities.filter(a => ['pending','ontrack','risk'].includes(a.status)).length
                            }}</div>
                    </div>
                    <div
                        class="bg-slate-50 dark:bg-slate-800 sakura:bg-pink-50 p-5 rounded-2xl border border-slate-100 dark:border-slate-700 sakura:border-pink-100 text-center relative overflow-hidden">
                        <div class="text-[10px] font-black uppercase text-slate-400 mb-1">‚ö†Ô∏è È¢®Èö™ÊåáÊï∏</div>
                        <div :class="['text-3xl font-black', getRiskLevelColor(getRiskScore(activeProject))]">{{
                            getRiskScore(activeProject) }}</div>
                        <div
                            :class="['absolute bottom-0 left-0 h-1 w-full', getRiskLevelColorBg(getRiskScore(activeProject))]">
                        </div>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-12">
                    <div :class="[themeClasses.innerCard, 'p-6 rounded-2xl border shadow-sm relative']">
                        <h4 class="text-xs font-black opacity-40 uppercase mb-4">‰ªªÂãôÁãÄÊÖãÂàÜ‰Ωà</h4>
                        <div class="relative h-64 w-full flex items-center justify-center">
                            <canvas id="statusChart"></canvas>
                        </div>
                    </div>
                    <div :class="[themeClasses.innerCard, 'p-6 rounded-2xl border shadow-sm relative']">
                        <h4 class="text-xs font-black opacity-40 uppercase mb-4">È¢®Èö™Á≠âÁ¥ö‰ΩîÊØî</h4>
                        <div class="relative h-64 w-full flex items-center justify-center">
                            <canvas id="riskChart"></canvas>
                        </div>
                    </div>
                </div>

                <div class="space-y-8">
                    <h4 class="text-xs font-black opacity-40 uppercase border-b pb-2">Âü∑Ë°åÊòéÁ¥∞</h4>
                    <div v-for="month in 12" :key="month" class="flex gap-6 break-inside-avoid">
                        <div class="w-12 text-center shrink-0 pt-1">
                            <div class="text-2xl font-black opacity-20">{{ month }}<span class="text-xs ml-0.5">Êúà</span>
                            </div>
                        </div>
                        <div class="flex-1 border-l-2 border-slate-100 dark:border-slate-700 pl-6 space-y-4 pb-6">
                            <div v-for="act in getActivitiesByMonth(month)" :key="act.id"
                                class="flex items-start gap-4 p-4 rounded-xl border border-slate-100 dark:border-slate-700 bg-white dark:bg-slate-800/30">
                                <div class="shrink-0 mt-1">
                                    <div :class="['w-2 h-2 rounded-full', getStatusDot(act.status)]"></div>
                                </div>
                                <div class="flex-1">
                                    <div class="flex justify-between items-start">
                                        <div
                                            :class="['font-bold text-base', act.status === 'done' ? 'line-through opacity-40' : '']">
                                            {{ act.name }}</div>
                                        <div
                                            class="text-[10px] font-black bg-slate-100 dark:bg-slate-700 px-2 py-0.5 rounded text-slate-500">
                                            {{ dayjs(act.date).format('MM/DD') }}</div>
                                    </div>
                                    <div class="flex gap-4 mt-1 text-xs text-slate-500"><span v-if="act.owner"><i
                                                class="fa-solid fa-user text-[10px]"></i> {{ act.owner }}</span><span
                                            :class="['font-bold uppercase', getStatusTextColor(act.status)]">{{
                                            statusText(act.status) }}</span></div>
                                    <div v-if="act.note" class="mt-2 text-xs opacity-70 border-l-2 pl-2">{{ act.note }}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </article>
        </main>

        <main v-if="currentTab === 'template'" class="animate-fade-in">
            <div class="grid grid-cols-1 lg:grid-cols-4 gap-6">
                <aside class="lg:col-span-1 space-y-4">
                    <button @click="createNewTemplate"
                        class="w-full py-4 bg-amber-500 sakura:bg-pink-500 text-white rounded-2xl shadow-lg hover:bg-amber-600 sakura:hover:bg-pink-400 transition-all font-black text-sm flex items-center justify-center gap-2">
                        <i class="fa-solid fa-plus"></i> ‚ú® Êñ∞Â¢ûÁ©∫ÁôΩÁØÑÊú¨
                    </button>
                    <div class="space-y-3 overflow-y-auto pr-1 h-[calc(100vh-250px)]">
                        <div v-for="t in templates" :key="t.id" @click="selectedTplId = t.id"
                            :class="['p-4 rounded-2xl cursor-pointer transition-all border-l-4 shadow-sm', selectedTplId === t.id ? 'bg-amber-50 border-amber-500 text-amber-900' : 'bg-white border-transparent opacity-60 hover:opacity-100']">
                            <div class="font-bold text-sm">{{ t.name }}</div>
                            <div class="text-[10px] opacity-60 mt-1">{{ t.activities.length }} ÁØÄÈªû</div>
                        </div>
                    </div>
                </aside>

                <article v-if="activeTemplate"
                    :class="[themeClasses.card, 'lg:col-span-3 p-8 rounded-3xl shadow-xl border transition-theme relative']">
                    <div class="absolute top-0 left-0 w-full h-1 bg-amber-400 rounded-t-3xl"></div>
                    <div class="flex justify-between items-start mb-8 pb-4 border-b border-slate-100">
                        <div class="w-full mr-10">
                            <label class="text-xs font-bold text-amber-500 uppercase mb-1 block">ÁØÑÊú¨ÂêçÁ®±</label>
                            <input v-model="activeTemplate.name"
                                class="text-2xl font-black bg-transparent outline-none w-full">
                        </div>
                        <button @click="deleteTemplate"
                            class="text-rose-400 hover:text-rose-600 text-sm font-bold shrink-0"><i
                                class="fa-solid fa-trash-can mr-1"></i> Âà™Èô§ÁØÑÊú¨</button>
                    </div>
                    <div class="grid grid-cols-2 gap-6 mb-8">
                        <div :class="[themeClasses.innerCard, 'p-4 rounded-xl border']">
                            <h4 class="text-xs font-bold mb-2">È†êË®≠È¢®Èö™</h4>
                            <div class="space-y-2 max-h-40 overflow-y-auto custom-scroll">
                                <div v-for="(r, i) in activeTemplate.risks"
                                    class="bg-white p-2 rounded border flex justify-between text-xs"><span>{{ r.desc
                                        }}</span><button @click="activeTemplate.risks.splice(i,1)"
                                        class="text-rose-400">√ó</button></div>
                            </div>
                            <button @click="activeTemplate.risks.push({level:'med',desc:'Êñ∞È¢®Èö™',action:''})"
                                class="text-xs text-indigo-500 font-bold mt-2">+ Âä†È¢®Èö™</button>
                        </div>
                        <div :class="[themeClasses.innerCard, 'p-4 rounded-xl border']">
                            <h4 class="text-xs font-bold mb-2">È†êË®≠Èóú‰øÇ‰∫∫</h4>
                            <div class="space-y-2 max-h-40 overflow-y-auto custom-scroll">
                                <div v-for="(c, i) in activeTemplate.contacts"
                                    class="bg-white p-2 rounded border flex justify-between text-xs"><span>{{ c.name }}
                                        - {{ c.info }}</span><button @click="activeTemplate.contacts.splice(i,1)"
                                        class="text-rose-400">√ó</button></div>
                            </div>
                            <button @click="activeTemplate.contacts.push({name:'Êñ∞ËßíËâ≤',info:''})"
                                class="text-xs text-indigo-500 font-bold mt-2">+ Âä†ËßíËâ≤</button>
                        </div>
                    </div>
                    <h4 class="font-bold text-lg mb-4">È†êË®≠‰ªªÂãôÁØÄÈªû</h4>
                    <div class="space-y-2">
                        <div v-for="(act, i) in activeTemplate.activities" :key="i"
                            class="flex items-center gap-3 p-3 bg-slate-50 rounded-xl border border-slate-200">
                            <input type="date" v-model="act.date"
                                class="bg-white border rounded px-2 py-1 text-xs w-28">
                            <select v-model="act.type" class="bg-white border rounded px-2 py-1 text-xs">
                                <option value="activity">‰ªªÂãô</option>
                                <option value="deadline">ÈáåÁ®ãÁ¢ë</option>
                            </select>
                            <input v-model="act.name"
                                class="flex-1 bg-transparent border-b border-transparent focus:border-indigo-300 outline-none text-sm font-bold">
                            <input v-model="act.owner" placeholder="È†êË®≠Ë≤†Ë≤¨‰∫∫"
                                class="w-20 bg-transparent border-b border-transparent focus:border-indigo-300 outline-none text-xs text-center">
                            <button @click="activeTemplate.activities.splice(i,1)"
                                class="text-slate-300 hover:text-rose-500">√ó</button>
                        </div>
                        <button @click="addTemplateActivity"
                            class="w-full py-2 border-2 border-dashed border-slate-200 rounded-xl text-slate-400 text-xs font-bold hover:border-amber-400 hover:text-amber-500">+
                            Êñ∞Â¢ûÁØÄÈªû</button>
                    </div>
                </article>
            </div>
        </main>
    </div>

    <script src="app.js"></script>
</body>
</html>
