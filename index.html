<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¨ˆç•«ç®¡ç†åŠ©æ‰‹ - æ——è‰¦ä¿®å¾©ç‰ˆ</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/dayjs@1/dayjs.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* åŸºç¤è¨­å®š */
        :root { --font-main: 'Helvetica Neue', Helvetica, Arial, 'Microsoft JhengHei', sans-serif; }
        [v-cloak] { display: none !important; }
        html { font-family: var(--font-main); font-size: 16px; } /* ä¿®æ­£é è¨­å­—é«”å¤§å°ï¼Œé¿å…éå¤§ */
        body { line-height: 1.75; overflow-y: scroll; } /* å¼·åˆ¶å·è»¸é¿å…è·³å‹• */
        
        /* å…ƒä»¶æ¨£å¼ */
        .diamond { transform: rotate(45deg); }
        .transition-theme { transition: background-color 0.4s ease, color 0.4s ease, border-color 0.4s ease, box-shadow 0.4s ease; }
        
        /* åˆ—å°å°ˆç”¨æ¨£å¼ */
        @media print {
            .no-print { display: none !important; }
            body, .print-card { background: white !important; color: black !important; box-shadow: none !important; border: none !important; }
            .print-area { width: 100% !important; margin: 0 !important; padding: 0 !important; }
            ::-webkit-scrollbar { display: none; }
        }
        
        /* å·¥å…·é¡ */
        .btn-flex { display: inline-flex; align-items: center; justify-content: center; line-height: 1; vertical-align: middle; }
        
        /* å·è»¸ç¾åŒ– */
        ::-webkit-scrollbar { height: 8px; width: 8px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: rgba(156, 163, 175, 0.5); border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: rgba(156, 163, 175, 0.8); }
        
        /* å‹•ç•« */
        @keyframes slideUp { from { opacity: 0; transform: translateY(20px) translateX(-50%); } to { opacity: 1; transform: translateY(0) translateX(-50%); } }
        .animate-toast { animation: slideUp 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards; }
        
        .hover-lift { transition: transform 0.2s cubic-bezier(0.4, 0, 0.2, 1), box-shadow 0.2s; }
        .hover-lift:hover { transform: translateY(-4px); box-shadow: 0 20px 25px -5px rgb(0 0 0 / 0.1); }
        .focus-ring:focus { outline: none; ring: 2px; ring-color: rgba(99, 102, 241, 0.3); }
    </style>
</head>
<body :class="[themeClasses.body, 'transition-theme min-h-screen pb-20']">
    <div id="app" v-cloak class="max-w-7xl mx-auto p-4 md:p-8">
        
        <!-- Toast é€šçŸ¥ -->
        <div v-if="showToast" class="fixed bottom-10 left-1/2 z-50 bg-emerald-600 text-white px-8 py-4 rounded-full font-bold shadow-2xl flex items-center gap-3 animate-toast">
            <i class="fa-solid fa-circle-check text-xl"></i>
            <span>{{ toastMessage }}</span>
        </div>

        <!-- é ‚éƒ¨å°èˆª -->
        <header :class="[themeClasses.card, 'no-print flex flex-col md:flex-row justify-between items-center mb-8 p-8 rounded-[2rem] border shadow-xl transition-theme']">
            <div class="mb-6 md:mb-0 text-center md:text-left">
                <h1 :class="[themeClasses.brand, 'text-3xl md:text-4xl font-black tracking-tighter flex items-center justify-center md:justify-start gap-3']">
                    <i class="fa-solid fa-ghost opacity-80"></i>
                    <span>è¨ˆç•«ç®¡ç†åŠ©æ‰‹</span>
                </h1>
                <p class="text-sm md:text-base opacity-50 font-bold mt-2 tracking-wide">2026 å¹´åº¦ä¸»æ§å° Â· å°ˆæ¥­å ±å‘Šæ•´åˆ</p>
            </div>
            
            <div class="flex flex-wrap gap-3 items-center justify-center">
                <div class="flex bg-black/5 p-1.5 rounded-xl border border-slate-500/10 gap-1 shadow-inner">
                    <button v-for="t in ['gray','dark','light']" :key="t" @click="setTheme(t)" 
                            :class="[themeBtnClass(theme === t), 'w-10 h-10 btn-flex text-lg rounded-lg transition-all shadow-sm']"
                            :title="t">
                        <i :class="['fa-solid', t==='gray'?'fa-ghost':t==='dark'?'fa-moon':'fa-sun']"></i>
                    </button>
                </div>
                <button @click="exportData" class="btn-flex px-6 py-3 bg-slate-700 text-white rounded-xl text-sm font-bold hover:bg-slate-600 shadow-lg hover-lift gap-2 transition-all">
                    <i class="fa-solid fa-download"></i>å‚™ä»½
                </button>
                <label class="btn-flex px-6 py-3 bg-indigo-600 text-white rounded-xl text-sm font-bold cursor-pointer hover:bg-indigo-500 shadow-lg hover-lift gap-2 transition-all">
                    <i class="fa-solid fa-upload"></i>åŒ¯å…¥
                    <input type="file" @change="importData" class="hidden" accept=".json">
                </label>
            </div>
        </header>

        <!-- åˆ†é åˆ‡æ› -->
        <nav class="no-print flex p-1.5 rounded-2xl w-fit mb-10 border transition-theme mx-auto md:mx-0 shadow-md" :class="themeClasses.tabBg">
            <button v-for="tab in tabs" :key="tab.id"
                    @click="currentTab = tab.id" :class="tabClass(currentTab === tab.id)">
                <i :class="['fa-solid', tab.icon, 'mr-2']"></i>{{tab.n}}
            </button>
        </nav>

        <!-- Tab 1: å¹´åº¦å…¨è¦½ (Gantt) -->
        <main v-if="currentTab === 'time'" class="animate-fade-in">
            <section :class="[themeClasses.card, 'p-6 md:p-10 rounded-[3rem] shadow-2xl border transition-theme overflow-hidden hover-lift']">
                <div class="flex flex-col md:flex-row items-center justify-between mb-10 gap-6">
                    <h2 class="font-black text-2xl md:text-3xl tracking-tight flex items-center gap-3">
                        <i class="fa-solid fa-chart-gantt text-indigo-500"></i>2026 å¹´åº¦æˆ°ç•¥
                    </h2>
                    <div class="flex gap-6 text-xs font-black uppercase tracking-widest opacity-60">
                        <span class="flex items-center"><span class="w-4 h-4 rounded-full bg-indigo-500 mr-2 shadow-md"></span> æ´»å‹•é»</span>
                        <span class="flex items-center"><span class="w-4 h-4 diamond bg-rose-500 mr-2 shadow-lg"></span> DEADLINE</span>
                    </div>
                </div>
                <div class="relative overflow-x-auto pb-4">
                    <div class="min-w-[1000px] xl:min-w-full relative">
                        <!-- æœˆä»½è»¸ -->
                        <div class="flex border-b-2 border-slate-500/10 mb-8 text-sm font-black opacity-40">
                            <div v-for="m in 12" :key="m" class="flex-1 text-center py-4">{{m}}æœˆ</div>
                        </div>
                        
                        <!-- å°ˆæ¡ˆåˆ— -->
                        <div v-if="projects.length === 0" class="text-center py-10 opacity-30 font-bold">ç›®å‰ç„¡è¨ˆç•«ï¼Œè«‹è‡³ã€Œè¨ˆç•«ç®¡ç†ã€æ–°å¢</div>
                        
                        <div v-for="p in projects" :key="p.id" class="relative h-20 border-b border-slate-500/5 flex items-center group">
                            <div class="absolute -left-0 -top-2 text-xs font-black opacity-40 group-hover:text-indigo-500 transition-all uppercase tracking-tighter z-10 bg-inherit pr-2 truncate max-w-[150px]">{{p.name}}</div>
                            <div class="w-full h-1 bg-slate-500/10 rounded-full"></div>
                            
                            <!-- ç¯€é» -->
                            <div v-for="act in p.activities" :key="act.id" 
                                 class="absolute top-1/2 -translate-y-1/2 transition-all duration-500" 
                                 :style="{ left: getYearPos(act.date) + '%' }"
                                 :title="`${act.date} : ${act.name}`">
                                <div :class="['cursor-pointer transition-all hover:scale-[1.8] z-10 relative border-2', 
                                              act.type === 'deadline' ? 'w-5 h-5 diamond bg-rose-500 shadow-lg' : 'w-4 h-4 rounded-full bg-indigo-500 shadow-md',
                                              act.done ? 'opacity-30 grayscale' : '',
                                              theme === 'light' ? 'border-white' : 'border-slate-800']" 
                                     @click="toggleDone(act)"></div>
                            </div>
                        </div>

                        <!-- ä»Šæ—¥ç·š (åƒ…åœ¨ 2026 å¹´é¡¯ç¤º) -->
                        <div v-if="isCurrentYear" class="absolute top-0 bottom-0 w-0.5 bg-rose-500/40 z-0 pointer-events-none dashed" :style="{ left: getYearPos(today) + '%' }">
                            <div class="bg-rose-500 text-white text-[10px] px-2 py-0.5 rounded-full absolute -top-8 -left-5 font-bold shadow-sm whitespace-nowrap">TODAY</div>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <!-- Tab 2: è¨ˆç•«ç®¡ç† -->
        <main v-if="currentTab === 'project'" class="grid grid-cols-1 lg:grid-cols-4 gap-8">
            <!-- å·¦å´åˆ—è¡¨ -->
            <aside class="lg:col-span-1 space-y-4">
                <div v-for="p in projects" :key="p.id" @click="selectedPid = p.id" :class="projectItemClass(p.id)" class="hover-lift group relative overflow-hidden">
                    <div class="text-lg font-bold truncate pr-6">{{ p.name }}</div>
                    <div class="text-xs font-bold mt-1 opacity-50 flex justify-between">
                        <span>{{ calculateProgress(p) }}% å®Œæˆ</span>
                        <span>{{ p.activities.length }} äº‹é …</span>
                    </div>
                    <!-- é€²åº¦æ¢èƒŒæ™¯ -->
                    <div class="absolute bottom-0 left-0 h-1 bg-indigo-500/20 transition-all duration-500" :style="{ width: calculateProgress(p) + '%' }"></div>
                </div>
                <button @click="addProject" class="w-full py-6 border-4 border-dashed border-slate-400/20 rounded-[2rem] text-slate-400 hover:text-indigo-500 hover:border-indigo-500/30 transition-all font-black text-2xl hover-lift bg-transparent">
                    <i class="fa-solid fa-plus"></i>
                </button>
            </aside>

            <!-- å³å´ç·¨è¼¯å€ -->
            <article v-if="activeProject" :class="[themeClasses.card, 'lg:col-span-3 p-8 md:p-12 rounded-[3rem] shadow-2xl border transition-theme']">
                <!-- æ¨™é¡Œèˆ‡åˆªé™¤ -->
                <div class="mb-10 flex flex-col md:flex-row justify-between items-start md:items-center gap-6 border-b-2 border-slate-500/10 pb-6">
                    <input v-model="activeProject.name" :class="[themeClasses.inputTitle, 'text-3xl md:text-4xl font-black bg-transparent outline-none w-full pb-2 transition-colors']" placeholder="è¼¸å…¥è¨ˆç•«åç¨±...">
                    <button @click="deleteProject" class="shrink-0 text-rose-500 font-bold px-5 py-2 hover:bg-rose-500/10 rounded-xl transition-all text-sm">
                        <i class="fa-solid fa-trash-can mr-2"></i>åˆªé™¤è¨ˆç•«
                    </button>
                </div>

                <!-- è³‡è¨Šå€å¡Š -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-12">
                    <!-- å·¦ï¼šè¯çµ¡è³‡è¨Š -->
                    <div :class="[themeClasses.innerCard, 'p-6 rounded-[2rem] border shadow-sm']">
                        <h3 class="text-xs font-black opacity-40 uppercase tracking-widest mb-4 flex items-center gap-2">
                            <i class="fa-solid fa-building"></i> æ‰¿è¾¦å–®ä½ & çª—å£
                        </h3>
                        <input v-model="activeProject.org" placeholder="å–®ä½åç¨±" :class="[themeClasses.inputField, 'w-full mb-4 rounded-xl px-4 py-2 font-bold outline-none border focus:border-indigo-400 transition-all']">
                        
                        <div class="space-y-3 max-h-48 overflow-y-auto pr-2 custom-scroll">
                            <div v-for="(contact, cIdx) in activeProject.contacts" :key="cIdx" class="flex gap-2">
                                <input v-model="contact.name" placeholder="å§“å" :class="[themeClasses.inputField, 'w-1/3 rounded-lg px-3 py-1.5 text-sm outline-none border focus:border-indigo-400']">
                                <input v-model="contact.info" placeholder="é›»è©±/Email" :class="[themeClasses.inputField, 'flex-1 rounded-lg px-3 py-1.5 text-sm outline-none border focus:border-indigo-400']">
                                <button @click="removeContact(cIdx)" class="text-rose-400 hover:text-rose-600 px-2"><i class="fa-solid fa-xmark"></i></button>
                            </div>
                        </div>
                        <button @click="addContact" class="text-indigo-500 font-bold text-xs mt-3 hover:underline">+ æ–°å¢çª—å£</button>
                    </div>

                    <!-- å³ï¼šé™„ä»¶è·¯å¾‘ -->
                    <div :class="[themeClasses.innerCard, 'p-6 rounded-[2rem] border shadow-sm']">
                        <h3 class="text-xs font-black opacity-40 uppercase tracking-widest mb-4 flex items-center gap-2 text-emerald-600">
                            <i class="fa-solid fa-folder-tree"></i> é™„ä»¶è·¯å¾‘ / é€£çµ
                        </h3>
                        <div class="space-y-3 max-h-60 overflow-y-auto pr-2 custom-scroll">
                            <div v-for="(link, lIdx) in activeProject.links" :key="lIdx" class="p-3 bg-black/5 rounded-xl border border-slate-500/5 group">
                                <div class="flex gap-2 mb-2">
                                    <input v-model="link.url" placeholder="C:\Users\Project æˆ– https://..." :class="[themeClasses.inputField, 'flex-1 rounded-lg px-3 py-1.5 text-xs outline-none border focus:border-emerald-400']">
                                    <button @click="removeLink(lIdx)" class="text-rose-400 hover:text-rose-600 px-1"><i class="fa-solid fa-xmark"></i></button>
                                </div>
                                <div class="flex justify-end gap-3">
                                    <button v-if="link.url && !isUrl(link.url)" @click="copyToClipboard(link.url)" class="text-xs font-bold text-indigo-500 hover:text-indigo-600"><i class="fa-regular fa-copy mr-1"></i>è¤‡è£½è·¯å¾‘</button>
                                    <a v-if="isUrl(link.url)" :href="link.url" target="_blank" class="text-xs font-bold text-emerald-600 hover:underline"><i class="fa-solid fa-external-link-alt mr-1"></i>é–‹å•Ÿé€£çµ</a>
                                </div>
                            </div>
                        </div>
                        <button @click="addLink" class="text-emerald-500 font-bold text-xs mt-3 hover:underline">+ æ–°å¢è·¯å¾‘æ¬„ä½</button>
                    </div>
                </div>

                <!-- ç¯€é»ç®¡ç† -->
                <div class="flex justify-between items-center mb-8">
                    <h3 class="font-black text-2xl">åŸ·è¡Œç¯€é»èˆ‡ç­†è¨˜</h3>
                    <button @click="addActivity" class="px-6 py-3 bg-indigo-600 text-white rounded-xl hover:bg-indigo-500 shadow-lg hover:shadow-indigo-500/30 font-bold transition-all text-sm">
                        <i class="fa-solid fa-plus mr-1"></i>æ–°å¢ç¯€é»
                    </button>
                </div>
                
                <div class="space-y-6">
                    <div v-if="activeProject.activities.length === 0" class="text-center py-12 opacity-30 border-2 border-dashed border-slate-500/20 rounded-3xl">
                        å°šç„¡åŸ·è¡Œç¯€é»ï¼Œè«‹é»æ“Šä¸Šæ–¹æŒ‰éˆ•æ–°å¢
                    </div>
                    <div v-for="(act, idx) in sortedActivities" :key="act.id" :class="[themeClasses.innerCard, 'p-6 rounded-[2rem] border transition-theme hover:shadow-md group relative overflow-hidden']">
                        <!-- å®ŒæˆèƒŒæ™¯æç¤º -->
                        <div v-if="act.done" class="absolute right-0 top-0 bottom-0 w-2 bg-emerald-500"></div>

                        <div class="flex flex-col xl:flex-row items-center gap-4 xl:gap-6">
                            <div class="flex gap-4 w-full xl:w-auto">
                                <select v-model="act.type" :class="[themeClasses.inputField, 'rounded-lg font-bold px-3 py-2 text-xs outline-none border bg-transparent cursor-pointer w-28']">
                                    <option value="activity">ä¸€èˆ¬æ´»å‹•</option>
                                    <option value="deadline">ğŸ”¥ DEADLINE</option>
                                </select>
                                <input type="date" v-model="act.date" :class="[themeClasses.inputField, 'rounded-lg px-3 py-2 font-bold outline-none border text-sm']">
                            </div>
                            
                            <input v-model="act.name" placeholder="äº‹é …åç¨±" :class="[act.done ? 'line-through opacity-50' : '', 'flex-1 bg-transparent text-xl font-black outline-none border-b border-transparent focus:border-indigo-300 transition-all w-full']">
                            
                            <div class="flex items-center gap-4 w-full xl:w-auto justify-end">
                                <button @click="act.showNote = !act.showNote" :class="[act.note ? 'text-amber-500' : 'text-slate-300 hover:text-slate-500', 'transition-colors']" title="ç­†è¨˜">
                                    <i class="fa-solid fa-note-sticky text-2xl"></i>
                                </button>
                                <button @click="toggleDone(act)" :class="['w-10 h-10 rounded-xl border-2 flex items-center justify-center transition-all', act.done ? 'bg-emerald-500 border-emerald-500 text-white' : 'border-slate-300 text-transparent hover:border-emerald-400']">
                                    <i class="fa-solid fa-check text-lg"></i>
                                </button>
                                <button @click="removeActivity(idx)" class="text-slate-300 hover:text-rose-500 text-xl w-8 text-center transition-colors">Ã—</button>
                            </div>
                        </div>
                        
                        <div v-if="act.showNote || (act.note && act.showNote !== false)" class="mt-6 pt-4 border-t border-slate-500/10 animate-fade-in">
                            <textarea v-model="act.note" :class="[themeClasses.inputField, 'w-full h-32 rounded-xl p-4 text-base outline-none resize-none border focus:border-indigo-300 shadow-inner']" placeholder="å¡«å¯«è©³ç´°åŸ·è¡Œç­†è¨˜..."></textarea>
                        </div>
                    </div>
                </div>
            </article>

            <!-- é¸æ“‡æç¤º -->
            <div v-else class="lg:col-span-3 flex flex-col items-center justify-center text-center opacity-30 min-h-[400px]">
                <i class="fa-solid fa-ghost text-6xl mb-4"></i>
                <p class="text-2xl font-black">è«‹å¾å·¦å´é¸æ“‡ä¸€å€‹è¨ˆç•«</p>
            </div>
        </main>

        <!-- Tab 3: å€‹åˆ¥å ±å‘Š -->
        <main v-if="currentTab === 'report'" class="animate-fade-in">
            <div v-if="!activeProject" class="flex flex-col items-center justify-center text-center p-20 opacity-30 font-black text-3xl h-[60vh]">
                <i class="fa-regular fa-file-lines text-6xl mb-6"></i>
                <div>è«‹å…ˆè‡³ã€Œè¨ˆç•«ç®¡ç†ã€é¸æ“‡å°ˆæ¡ˆ</div>
            </div>
            <article v-else :class="[themeClasses.card, 'p-8 md:p-16 rounded-[3rem] shadow-2xl border print-area print-card']">
                
                <div class="flex flex-col md:flex-row justify-between items-start border-b-8 border-slate-900/10 pb-10 mb-10 gap-6">
                    <div>
                        <h2 class="text-4xl md:text-6xl font-black mb-4">{{ activeProject.name }}</h2>
                        <div class="flex flex-wrap gap-3">
                            <span class="bg-indigo-600 text-white px-4 py-1.5 rounded-full text-sm font-bold">2026 å¹´åº¦åŸ·è¡Œè¿½è¹¤å ±å‘Š</span>
                            <span :class="calculateProgress(activeProject) >= 100 ? 'bg-emerald-600' : 'bg-slate-600'" class="text-white px-4 py-1.5 rounded-full text-sm font-bold">é”æˆåº¦: {{ calculateProgress(activeProject) }}%</span>
                        </div>
                    </div>
                    <button @click="window.print()" class="no-print shrink-0 bg-slate-800 text-white px-8 py-3 rounded-xl font-bold text-lg hover-lift shadow-xl flex items-center gap-2">
                        <i class="fa-solid fa-print"></i> åˆ—å° / PDF
                    </button>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-3 gap-8 mb-16 p-8 bg-black/5 rounded-[2.5rem] border border-slate-500/5">
                    <div>
                        <h4 class="text-xs font-black opacity-40 tracking-widest uppercase mb-2">åŸ·è¡Œå–®ä½</h4>
                        <p class="text-2xl font-black break-words">{{ activeProject.org || 'æœªå¡«å¯«' }}</p>
                    </div>
                    <div class="md:col-span-2">
                        <h4 class="text-xs font-black opacity-40 tracking-widest uppercase mb-2">è¯çµ¡çª—å£</h4>
                        <div v-if="activeProject.contacts.length" class="flex flex-wrap gap-3">
                            <div v-for="c in activeProject.contacts" class="bg-white/50 px-4 py-2 rounded-xl border border-slate-500/10 shadow-sm">
                                <span class="font-black text-lg mr-2">{{ c.name }}</span>
                                <span class="text-sm opacity-60">{{ c.info }}</span>
                            </div>
                        </div>
                        <div v-else class="opacity-30 italic">ç„¡è¯çµ¡äººè³‡è¨Š</div>
                    </div>
                </div>

                <div class="space-y-10">
                    <h4 class="text-sm font-black opacity-40 uppercase border-b-2 border-slate-500/10 pb-4">åŸ·è¡Œæ˜ç´° (æœˆåº¦è¿½è¹¤)</h4>
                    <div v-for="month in 12" :key="month" class="flex gap-6 md:gap-12 break-inside-avoid">
                        <div class="w-16 md:w-24 text-center shrink-0 pt-2">
                            <div class="text-3xl md:text-5xl font-black opacity-10">{{ month }}<span class="text-lg opacity-50 block">æœˆ</span></div>
                        </div>
                        <div class="flex-1 space-y-4 pb-8 border-l-4 border-slate-500/10 pl-6 md:pl-10 relative">
                            <!-- è£é£¾åœ“é» -->
                            <div class="absolute -left-[11px] top-6 w-4 h-4 rounded-full border-4 border-white bg-slate-300"></div>

                            <div v-if="getActivitiesByMonth(month).length === 0" class="text-base italic opacity-20 py-4 font-bold">æœ¬æœˆç„¡è¦åŠƒäº‹ä»¶</div>
                            
                            <div v-for="act in getActivitiesByMonth(month)" :key="act.id" 
                                 class="flex flex-col lg:flex-row gap-6 bg-black/5 p-6 md:p-8 rounded-[2rem] border border-slate-500/5 hover:bg-black/[0.07] transition-colors">
                                <div class="lg:w-24 shrink-0">
                                    <span class="text-xs font-black bg-white/60 px-3 py-1.5 rounded-lg border border-slate-500/10 block w-fit text-center mx-auto lg:mx-0">
                                        {{ dayjs(act.date).format('MM/DD') }}
                                    </span>
                                </div>
                                <div class="flex-1">
                                    <div class="flex items-start gap-4 mb-3">
                                        <i :class="['fa-solid text-2xl mt-1', act.done ? 'fa-circle-check text-emerald-500' : 'fa-hourglass-start text-amber-400']"></i>
                                        <div>
                                            <div :class="['font-black text-xl md:text-2xl leading-tight', act.done ? 'opacity-40 line-through decoration-2' : '']">{{ act.name }}</div>
                                            <div class="text-xs font-bold mt-1" :class="act.done ? 'text-emerald-600' : 'text-amber-600'">
                                                {{ act.done ? 'STATUS: COMPLETED' : 'STATUS: IN PROGRESS' }}
                                            </div>
                                        </div>
                                    </div>
                                    <p v-if="act.note" class="text-sm opacity-70 whitespace-pre-wrap leading-relaxed pl-10 border-l-2 border-slate-500/20 mt-2">{{ act.note }}</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </article>
        </main>
    </div>

    <script>
        const { createApp } = Vue;
        createApp({
            data() {
                return {
                    theme: localStorage.getItem('zenplan-theme') || 'gray',
                    currentTab: 'time',
                    selectedPid: null,
                    showToast: false,
                    toastMessage: '',
                    projects: JSON.parse(localStorage.getItem('zenplan-ultra-v1')) || [],
                    tabs: [
                        {id:'time',n:'å¹´åº¦å…¨è¦½',icon:'fa-calendar-days'},
                        {id:'project',n:'è¨ˆç•«ç®¡ç†',icon:'fa-list-check'},
                        {id:'report',n:'å€‹åˆ¥å ±å‘Š',icon:'fa-file-lines'}
                    ]
                }
            },
            computed: {
                activeProject() { 
                    if (!this.projects.length) return null;
                    return this.projects.find(p => p.id === this.selectedPid) || this.projects[0]; 
                },
                sortedActivities() { 
                    return this.activeProject?.activities.sort((a,b) => dayjs(a.date).diff(dayjs(b.date))) || []; 
                },
                today() { return dayjs().format('YYYY-MM-DD'); },
                isCurrentYear() { return dayjs().year() === 2026; },
                themeClasses() {
                    const themes = {
                        gray: { body: 'bg-zinc-100 text-zinc-800', card: 'bg-white border-zinc-200', brand: 'text-zinc-900', tabBg: 'bg-zinc-200 border-zinc-200', innerCard: 'bg-zinc-50 border-zinc-200', inputField: 'bg-white border-zinc-200 text-zinc-800 focus:border-indigo-400', inputTitle: 'border-zinc-100 text-zinc-900' },
                        dark: { body: 'bg-[#0f172a] text-slate-300', card: 'bg-[#1e293b] border-slate-700', brand: 'text-indigo-400', tabBg: 'bg-[#1e293b] border-slate-700', innerCard: 'bg-[#0f172a] border-slate-700', inputField: 'bg-[#0f172a] border-slate-600 text-slate-200 focus:border-indigo-500', inputTitle: 'border-slate-800 text-white' },
                        light: { body: 'bg-slate-50 text-slate-700', card: 'bg-white border-slate-200', brand: 'text-indigo-600', tabBg: 'bg-slate-200 border-slate-200', innerCard: 'bg-slate-50 border-slate-100', inputField: 'bg-white border-slate-200 text-slate-700 focus:border-indigo-400', inputTitle: 'border-slate-100 text-slate-900' }
                    };
                    return themes[this.theme];
                }
            },
            watch: {
                projects: { 
                    handler(val) { localStorage.setItem('zenplan-ultra-v1', JSON.stringify(val)); }, 
                    deep: true 
                },
                selectedPid(val) {
                    // ç•¶é¸æ“‡æ”¹è®Šæ™‚ï¼Œç¢ºä¿ UI æ›´æ–°
                }
            },
            methods: {
                dayjs,
                setTheme(t) { this.theme = t; localStorage.setItem('zenplan-theme', t); },
                themeBtnClass(active) { 
                    const styles = { gray:'bg-zinc-800', dark:'bg-indigo-500', light:'bg-indigo-600' };
                    return active ? `${styles[this.theme]} text-white shadow-xl scale-110` : 'text-slate-400 hover:text-indigo-500 bg-transparent'; 
                },
                tabClass(active) {
                    const activeStyles = { gray: 'bg-zinc-800 text-white shadow-xl', dark: 'bg-indigo-500 text-white shadow-xl', light: 'bg-indigo-600 text-white shadow-xl' };
                    return `px-6 md:px-10 py-3 text-sm md:text-base font-bold rounded-xl transition-all duration-300 ${active ? activeStyles[this.theme] + ' scale-105' : 'text-slate-400 hover:text-slate-500 bg-transparent'}`;
                },
                projectItemClass(id) {
                    const activeStyles = { gray: 'bg-white border-zinc-800 text-zinc-900 shadow-xl', dark: 'bg-indigo-900/40 border-indigo-400 text-indigo-100 shadow-xl', light: 'bg-white border-indigo-500 text-indigo-700 shadow-xl' };
                    return `p-5 rounded-[2rem] cursor-pointer transition-all border-l-[6px] border-t border-b border-r ${this.selectedPid === id ? activeStyles[this.theme] + ' scale-[1.02]' : 'bg-transparent border-transparent opacity-60 hover:opacity-100 hover:bg-black/5'}`;
                },
                getYearPos(date) { 
                    const start = dayjs('2026-01-01');
                    // ä¿®æ­£ï¼šé™åˆ¶ç™¾åˆ†æ¯”åœ¨ 0-100 ä¹‹é–“ï¼Œé¿å…é 2026 æ—¥æœŸå°è‡´è·‘ç‰ˆ
                    let percent = (dayjs(date).diff(start, 'day') / 365) * 100;
                    return Math.max(0, Math.min(100, percent));
                },
                calculateProgress(p) { if (!p || !p.activities || !p.activities.length) return 0; return Math.round((p.activities.filter(a => a.done).length / p.activities.length) * 100); },
                getActivitiesByMonth(m) { if (!this.activeProject) return []; return this.activeProject.activities.filter(a => dayjs(a.date).month() + 1 === m).sort((a,b) => dayjs(a.date).diff(dayjs(b.date))); },
                isUrl(str) { return str && (str.startsWith('http') || str.startsWith('https')); },
                copyToClipboard(text) { 
                    navigator.clipboard.writeText(text); 
                    this.toastMessage = 'å·²è¤‡è£½è·¯å¾‘ï¼';
                    this.showToast = true; 
                    setTimeout(() => this.showToast = false, 2000); 
                },
                toggleDone(act) { act.done = !act.done; },
                addProject() { 
                    const id = Date.now(); 
                    this.projects.unshift({ id, name: 'æ–°å¹´åº¦è¨ˆç•«', org: '', contacts: [], links: [], activities: [] }); 
                    this.selectedPid = id; 
                },
                deleteProject() { 
                    if (confirm('âš ï¸ ç¢ºå®šè¦åˆªé™¤æ•´å€‹è¨ˆç•«å—ï¼Ÿæ­¤å‹•ä½œç„¡æ³•å¾©åŸã€‚')) { 
                        this.projects = this.projects.filter(p => p.id !== this.selectedPid); 
                        this.selectedPid = this.projects.length ? this.projects[0].id : null; 
                    } 
                },
                addActivity() { 
                    this.activeProject.activities.push({ 
                        id: Date.now(), 
                        name: '', 
                        date: dayjs().year(2026).format('YYYY-MM-DD'), // é è¨­ç‚º 2026
                        done: false, 
                        type: 'activity', 
                        note: '', 
                        showNote: false 
                    }); 
                },
                removeActivity(idx) { this.activeProject.activities.splice(idx, 1); },
                addContact() { this.activeProject.contacts.push({ name: '', info: '' }); },
                removeContact(i) { this.activeProject.contacts.splice(i, 1); },
                addLink() { this.activeProject.links.push({ url: '' }); },
                removeLink(i) { this.activeProject.links.splice(i, 1); },
                exportData() { 
                    const link = document.createElement('a'); 
                    link.href = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(this.projects)); 
                    link.download = `zenplan_backup_${dayjs().format('YYYYMMDD')}.json`; 
                    link.click(); 
                },
                importData(event) { 
                    const file = event.target.files[0];
                    if(!file) return;
                    const reader = new FileReader(); 
                    reader.onload = (e) => { 
                        try {
                            const data = JSON.parse(e.target.result);
                            if(Array.isArray(data)) {
                                this.projects = data;
                                if(this.projects.length) this.selectedPid = this.projects[0].id;
                                this.toastMessage = 'åŒ¯å…¥æˆåŠŸï¼';
                                this.showToast = true;
                                setTimeout(() => this.showToast = false, 2000);
                            } else {
                                alert('æ ¼å¼éŒ¯èª¤ï¼šæª”æ¡ˆå¿…é ˆæ˜¯å°ˆæ¡ˆé™£åˆ—');
                            }
                        } catch(err) {
                            alert('æª”æ¡ˆæ¯€ææˆ–æ ¼å¼ä¸æ­£ç¢º');
                        }
                        // ä¿®æ­£ï¼šæ¸…ç©º input å…è¨±é‡è¤‡åŒ¯å…¥åŒæª”å
                        event.target.value = '';
                    }; 
                    reader.readAsText(file); 
                }
            },
            mounted() { 
                if(this.projects.length) this.selectedPid = this.projects[0].id; 
            }
        }).mount('#app')
    </script>
</body>
</html>
